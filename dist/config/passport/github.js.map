{"version":3,"sources":["../../../src/config/passport/github.js"],"names":["GitHubStrategy","Github","Strategy","githubStrategy","clientID","config","github","clientId","clientSecret","callbackURL","callbackUrl","scope","accessToken","refreshToken","profile","done","User","findBySocialId","provider","id","user","socialSignup","username","socialId","email","emails","value"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AACA,IAAMA,iBAAiBC,yBAAOC,QAA9B;;AAEA,IAAMC,iBAAiB,IAAIH,cAAJ,CAAmB;AAClCI,cAAUC,WAAOC,MAAP,CAAcC,QADU;AAElCC,kBAAcH,WAAOC,MAAP,CAAcE,YAFM;AAGlCC,iBAAaJ,WAAOC,MAAP,CAAcI,WAHO;AAIlCC,WAAO;AAJ2B,CAAnB;AAAA,wFAMnB,iBAAOC,WAAP,EAAoBC,YAApB,EAAkCC,OAAlC,EAA2CC,IAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAEyBC,eAAKC,cAAL,CAAoB,EAAEC,UAAUJ,QAAQI,QAApB,EAA8BC,IAAIL,QAAQK,EAA1C,EAApB,CAFzB;;AAAA;AAEYC,4BAFZ;;AAAA,4BAIYA,IAJZ;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAKyBJ,eAAKK,YAAL,CAAkB;AAC3BH,sCAAUJ,QAAQI,QADS;AAE3BN,oDAF2B;AAG3BU,sCAAWR,QAAQQ,QAHQ;AAI3BC,sCAAUT,QAAQK,EAJS;AAK3BK,mCAAOV,QAAQW,MAAR,CAAe,CAAf,EAAkBC;AALE,yBAAlB,CALzB;;AAAA;AAKYN,4BALZ;;AAAA;AAAA,yDAceL,KAAK,IAAL,EAAWK,IAAX,CAdf;;AAAA;AAAA;AAAA;AAAA,yDAgBeL,kBAAQ,IAAR,CAhBf;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KANmB;;AAAA;AAAA;AAAA;AAAA,IAAvB;;kBA2BeZ,c","file":"github.js","sourcesContent":["import Github from 'passport-github';\nimport config from 'config';\nimport User from 'db/models/User';\nconst GitHubStrategy = Github.Strategy;\n\nconst githubStrategy = new GitHubStrategy({\n        clientID: config.github.clientId,\n        clientSecret: config.github.clientSecret,\n        callbackURL: config.github.callbackUrl,\n        scope: 'user:email'\n    },\n    async (accessToken, refreshToken, profile, done) => {\n        try {\n            let user = await User.findBySocialId({ provider: profile.provider, id: profile.id });\n\n            if(!user) {\n                user = await User.socialSignup({\n                    provider: profile.provider,\n                    accessToken,\n                    username : profile.username,\n                    socialId: profile.id,\n                    email: profile.emails[0].value\n                });\n            }\n\n            return done(null, user);\n        } catch(e) {\n            return done(e, null);\n        }\n    }\n);\n\nexport default githubStrategy;"]}