{"version":3,"sources":["../../../src/config/passport/google.js"],"names":["GoogleStrategy","Google","Strategy","googleStrategy","clientID","config","google","clientId","clientSecret","callbackURL","callbackUrl","scope","accessToken","refreshToken","profile","done","User","findBySocialId","provider","id","user","socialSignup","username","displayName","socialId","email","emails","value"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAEA,IAAMA,iBAAiBC,8BAAOC,QAA9B;;AAEA,IAAMC,iBAAiB,IAAIH,cAAJ,CAAmB;AAClCI,cAAUC,WAAOC,MAAP,CAAcC,QADU;AAElCC,kBAAcH,WAAOC,MAAP,CAAcE,YAFM;AAGlCC,iBAAaJ,WAAOC,MAAP,CAAcI,WAHO;AAIlCC,WAAO,CAAC,SAAD,EAAY,OAAZ;AAJ2B,CAAnB;AAAA,wFAMnB,iBAAOC,WAAP,EAAoBC,YAApB,EAAkCC,OAAlC,EAA2CC,IAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAEyBC,eAAKC,cAAL,CAAoB,EAAEC,UAAUJ,QAAQI,QAApB,EAA8BC,IAAIL,QAAQK,EAA1C,EAApB,CAFzB;;AAAA;AAEYC,4BAFZ;;AAAA,4BAIYA,IAJZ;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAKyBJ,eAAKK,YAAL,CAAkB;AAC3BH,sCAAUJ,QAAQI,QADS;AAE3BN,oDAF2B;AAG3BU,sCAAWR,QAAQS,WAHQ;AAI3BC,sCAAUV,QAAQK,EAJS;AAK3BM,mCAAOX,QAAQY,MAAR,CAAe,CAAf,EAAkBC;AALE,yBAAlB,CALzB;;AAAA;AAKYP,4BALZ;;AAAA;AAAA,yDAceL,KAAK,IAAL,EAAWK,IAAX,CAdf;;AAAA;AAAA;AAAA;AAAA,yDAgBeL,kBAAQ,IAAR,CAhBf;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KANmB;;AAAA;AAAA;AAAA;AAAA,IAAvB;;kBA2BeZ,c","file":"google.js","sourcesContent":["import Google from 'passport-google-oauth20';\nimport config from 'config';\nimport User from 'db/models/User';\n\nconst GoogleStrategy = Google.Strategy;\n\nconst googleStrategy = new GoogleStrategy({\n        clientID: config.google.clientId,\n        clientSecret: config.google.clientSecret,\n        callbackURL: config.google.callbackUrl,\n        scope: ['profile', 'email']\n    },\n    async (accessToken, refreshToken, profile, done) => {\n        try {\n            let user = await User.findBySocialId({ provider: profile.provider, id: profile.id });\n\n            if(!user) {\n                user = await User.socialSignup({\n                    provider: profile.provider,\n                    accessToken,\n                    username : profile.displayName,\n                    socialId: profile.id,\n                    email: profile.emails[0].value\n                });\n            }\n\n            return done(null, user);\n        } catch(e) {\n            return done(e, null);\n        }\n    }\n);\n\nexport default googleStrategy;"]}